{"version":3,"names":["val","createUniqueKey","JSEventEmitter","getListenerPool","event","eventPool","addListener","listener","uniqKey","listenerPool","emit","args","setTimeout","listeners","Object","values","forEach","e","Logger","warn"],"sources":["JSEventEmitter.ts"],"sourcesContent":["import { Logger } from '../utils/logger';\n\ntype Listener = (...args: unknown[]) => void;\ntype ListenerPool = Record<number, Listener>;\n\nlet val = 0;\nfunction createUniqueKey() {\n  return val++;\n}\n\nexport default class JSEventEmitter {\n  private eventPool: Record<string, ListenerPool> = {};\n  private getListenerPool(event: string) {\n    if (!this.eventPool[event]) this.eventPool[event] = {};\n    return this.eventPool[event];\n  }\n\n  addListener(event: string, listener: Listener) {\n    const uniqKey = createUniqueKey();\n    const listenerPool = this.getListenerPool(event);\n\n    listenerPool[uniqKey] = listener;\n\n    return () => {\n      delete listenerPool[uniqKey];\n    };\n  }\n\n  emit(event: string, ...args: unknown[]) {\n    setTimeout(() => {\n      const listenerPool = this.getListenerPool(event);\n      const listeners = Object.values<Listener>(listenerPool);\n      listeners.forEach((listener) => {\n        try {\n          listener(...args);\n        } catch (e) {\n          Logger.warn('[JSEventEmitter]', e);\n        }\n      });\n    }, 0);\n  }\n}\n"],"mappings":";;;;;;;AAAA;;;;AAKA,IAAIA,GAAG,GAAG,CAAV;;AACA,SAASC,eAAT,GAA2B;EACzB,OAAOD,GAAG,EAAV;AACD;;AAEc,MAAME,cAAN,CAAqB;EAAA;IAAA,mCACgB,EADhB;EAAA;;EAE1BC,eAAe,CAACC,KAAD,EAAgB;IACrC,IAAI,CAAC,KAAKC,SAAL,CAAeD,KAAf,CAAL,EAA4B,KAAKC,SAAL,CAAeD,KAAf,IAAwB,EAAxB;IAC5B,OAAO,KAAKC,SAAL,CAAeD,KAAf,CAAP;EACD;;EAEDE,WAAW,CAACF,KAAD,EAAgBG,QAAhB,EAAoC;IAC7C,MAAMC,OAAO,GAAGP,eAAe,EAA/B;IACA,MAAMQ,YAAY,GAAG,KAAKN,eAAL,CAAqBC,KAArB,CAArB;IAEAK,YAAY,CAACD,OAAD,CAAZ,GAAwBD,QAAxB;IAEA,OAAO,MAAM;MACX,OAAOE,YAAY,CAACD,OAAD,CAAnB;IACD,CAFD;EAGD;;EAEDE,IAAI,CAACN,KAAD,EAAoC;IAAA,kCAAjBO,IAAiB;MAAjBA,IAAiB;IAAA;;IACtCC,UAAU,CAAC,MAAM;MACf,MAAMH,YAAY,GAAG,KAAKN,eAAL,CAAqBC,KAArB,CAArB;MACA,MAAMS,SAAS,GAAGC,MAAM,CAACC,MAAP,CAAwBN,YAAxB,CAAlB;MACAI,SAAS,CAACG,OAAV,CAAmBT,QAAD,IAAc;QAC9B,IAAI;UACFA,QAAQ,CAAC,GAAGI,IAAJ,CAAR;QACD,CAFD,CAEE,OAAOM,CAAP,EAAU;UACVC,cAAA,CAAOC,IAAP,CAAY,kBAAZ,EAAgCF,CAAhC;QACD;MACF,CAND;IAOD,CAVS,EAUP,CAVO,CAAV;EAWD;;AA9BiC"}